<ion-header class="bg_grey n_contact n_ad_con">
  <ion-navbar>
    <ion-grid>
      <ion-row>
        <ion-col col-11 class="p_left">
          <h6 class="add_com_tit">{{dealTitle}}</h6>
        </ion-col>
      </ion-row>
    </ion-grid>
    <div (click)="goBack()" class="close_new_deal_btn">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="22px" height="22px" viewBox="0 0 22 22"
        version="1.1">
        <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
        <title>cross-thick</title>
        <desc>Created with Sketch.</desc>
        <defs/>
        <g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-45.000000, -3819.000000)"
          opacity="0.25">
          <g id="Contact-creation" transform="translate(0.000000, 3735.000000)" fill="#000000">
            <path d="M54.5918831,93.5918831 L54.5918831,81.5918831 L57.5918831,81.5918831 L57.5918831,93.5918831 L69.5918831,93.5918831 L69.5918831,96.5918831 L57.5918831,96.5918831 L57.5918831,108.591883 L54.5918831,108.591883 L54.5918831,96.5918831 L42.5918831,96.5918831 L42.5918831,93.5918831 L54.5918831,93.5918831 Z"
              id="cross-thick" transform="translate(56.091883, 95.091883) rotate(45.000000) translate(-56.091883, -95.091883) "
            />
          </g>
        </g>
      </svg>
    </div>
  </ion-navbar>
</ion-header>
<ion-content>
  <div class="new_cont_list">
    <div class="new_cont_list_in" *ngIf="!showloader">
      <div class="new_con_form">
        <form (ngSubmit)="addNewDeal()">
          <div class="cr_form_group new_con_form p_left p_right">
            <div [ngClass]="nameErrorClass ? 'error_class in_item':' in_item'">
              <div class="in_image">
                <svg width="25px" height="25px" viewBox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                  <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
                  <title>notif-nav__Deal—default</title>
                  <desc>Created with Sketch.</desc>
                  <defs></defs>
                  <g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-48.000000, -377.000000)"
                    fill-opacity="0.2">
                    <g id="Notif-icon" transform="translate(0.000000, 313.000000)" fill="#000000">
                      <path d="M70.1195885,83.6921091 C70.1920165,82.5870679 70.3550823,80.5398457 70.4456173,79.1812037 C70.771749,79.0001337 72.021749,78.3297634 72.5833745,77.8224588 C72.5833745,77.8224588 72.2572428,81.6993107 72.057963,83.8913889 C71.8586831,86.0833642 70.2101235,88.0217387 67.6920165,88.0217387 L53.3804938,88.0217387 C49.9565226,88.0217387 48.9420165,85.014537 48.8514815,83.6014712 C48.7609465,82.1885082 48.4710288,78.9275 48.4167078,78.0218416 C49.0869753,78.5290432 49.7210288,78.9275 50.5181481,79.3080556 C50.5181481,79.3080556 50.7263786,82.5155658 50.8442798,83.5290432 C51.0253498,85.0870679 51.8948971,86.0471502 53.5434568,86.0471502 L67.6739095,86.0471502 C69.1594033,86.0471502 70.0471605,84.7971502 70.1195885,83.6921091 Z M61.6594342,81.0742798 C61.6594342,81.7746914 61.0916358,82.3423868 60.3913272,82.3423868 C59.6909156,82.3423868 59.1232202,81.7746914 59.1232202,81.0742798 L59.1232202,80.2590535 C59.1232202,79.5587449 59.6909156,78.9910494 60.3913272,78.9910494 C61.0916358,78.9910494 61.6594342,79.5587449 61.6594342,80.2590535 L61.6594342,81.0742798 Z M68.9239712,67.2065844 C71.1751029,67.2065844 73,69.0314815 73,71.2826132 L73,75.9202675 C70.5205761,78.2645062 66.89393,79.7226337 62.9066872,80.1521605 C62.8504115,78.8130658 61.74393,77.7410494 60.391358,77.7410494 C59.0473251,77.7410494 57.9459877,78.7993827 57.876749,80.1263374 C53.7696502,79.6176955 49.8492798,77.95 48,75.9202675 L48,71.2826132 C48,69.0314815 49.8248971,67.2065844 52.0761317,67.2065844 L55.4972222,67.2065844 C55.7957819,65.3878601 57.3740741,64 59.2771605,64 L61.5054527,64 C63.408642,64 64.9869342,65.3878601 65.2853909,67.2065844 L68.9239712,67.2065844 Z M59.4130658,65.9294239 C58.5815844,65.9294239 57.8751029,66.4630658 57.6164609,67.2065844 L63.1661523,67.2065844 C62.9075103,66.4630658 62.2011317,65.9294239 61.3695473,65.9294239 L59.4130658,65.9294239 Z"
                        id="notif-nav__Deal—default"></path>
                    </g>
                  </g>
                </svg>
              </div>
              <ion-item [class.item_active]="deal.name!= ''" *ngIf="labelName==='CREATE'">
                <ion-input (input)="focusDealName(deal.name)" name="deal_name" type="text" placeholder="Deal name" [(ngModel)]="deal.name"></ion-input>
              </ion-item>
               <ion-item [class.item_active]="deal.name!= ''" *ngIf="labelName==='UPDATE'" >
                <ion-input (input)="focusDealName(deal.name)" name="deal_name" type="text" placeholder="Related deal" [(ngModel)]="deal.name" readonly="{{isReadonly}}"></ion-input>
              </ion-item>
              <div class="dot_icon" *ngIf="!deal.name"></div>
            </div>

            <div [ngClass]="contactErrorClass ? 'error_class in_item dl_related_con':'in_item dl_related_con'" [class.auto_filt_sl_img]="isContactSelected"
              id="reletedcontact">
              <div class="in_image" *ngIf="!isContactSelected">
                <svg width="19px" height="20px" viewBox="0 0 19 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                  <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
                  <title>creation__contact-icon—default</title>
                  <desc>Created with Sketch.</desc>
                  <defs></defs>
                  <g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-26.000000, -997.000000)"
                    opacity="0.3">
                    <g id="Create-Deal" transform="translate(0.000000, 823.000000)" fill="#000000">
                      <path d="M38.4061006,175.322048 C39.114773,175.322048 40.2992868,176.284471 40.2992868,177.511383 C40.2992868,178.75168 40.1089342,179.774695 40.1300934,180.546765 C40.4631903,180.467498 40.8492653,180.694879 40.8492653,181.477528 C40.8492653,182.712295 40.1485275,183.783158 39.795634,183.783158 C39.6607442,183.783158 39.6092087,183.745489 39.5457312,183.660852 C39.4822536,183.946421 38.8926016,185.480702 38.1734297,186.252772 L38.1734297,187.781042 C39.0195567,188.024293 41.9486614,188.741862 42.6102066,188.87571 C44.4399152,189.245915 44.5087627,190.684259 44.5087627,192.550996 C42.4568826,193.534578 38.6176924,194 35.3178211,194 C32.0179497,194 28.7657667,193.693272 26.0000045,192.603894 C26.0000045,190.869322 25.9850167,189.374393 27.6879305,188.946 C29.0486907,188.603686 32.3246778,187.791622 32.3246778,187.791622 C32.3352574,187.506053 32.3246778,186.258062 32.3246778,186.258062 C31.4256528,185.496572 31.0449477,184.036989 30.9708906,183.698602 C30.9312171,183.754065 30.8309514,183.77867 30.7251555,183.77867 C30.4493647,183.77867 29.6382625,182.829953 29.6382625,181.541006 C29.6382625,180.795385 29.9820192,180.467498 30.3680942,180.546765 C30.2094003,180.049684 30.2199799,178.494965 30.2199799,177.871009 C30.2199799,175.597038 32.1449048,174 35.063991,174 C36.8619608,174 37.9513384,174.782649 38.4061006,175.322048"
                        id="creation__contact-icon—default"></path>
                    </g>
                  </g>
                </svg>
              </div>
              <div class="in_image" *ngIf="isContactSelected">
                <div *ngIf="selectedContact.picture_path==null" class="no_img bg_{{selectedContact.name | slice:0:1}}">
                  <span>{{selectedContact.name | slice:0:1}}{{selectedContact.name | slice:1:2}}</span>
                </div>
                <!-- <img *ngIf="selectedContact.picture_path==null" src="assets/imgs/company__defaut-icon.png" class="flag" /> -->
                <img *ngIf="selectedContact.picture_path !=null" src="{{selectedContact.picture_path}}" class="flag" />
              </div>
              <div>

                <ng-template #withFlags let-attrs="attrs">
                  <div *ngIf="attrs.data.picture_path!=null">
                    <img src="{{attrs.data.picture_path}}" class="flag" />
                    <span [innerHTML]="attrs.data.name | boldprefix:attrs.keyword"></span>
                  </div>
                  <div *ngIf="attrs.data.picture_path==null">
                    <div class="bg_{{attrs.data.name | slice:0:1}} flag">
                      <span>{{attrs.data.name | slice:0:1}}{{attrs.data.name | slice:1:2}}</span>
                    </div>
                    <span [innerHTML]="attrs.data.name | boldprefix:attrs.keyword"></span>
                  </div>
                </ng-template>
                <ion-auto-complete [class.relatedname]="labelName==='UPDATE'" #nameInputToFocus (focusin)="focusInFunction()" (focusout)="focusOutFunction()" (itemSelected)="getSelection($event)"
                  name="related_contact" [(ngModel)]="deal.contactId" [template]="withFlags" #searchbar [dataProvider]="autosuggest"
                  [options]="{ placeholder : 'Related contact' }"></ion-auto-complete>
              </div>
              <div *ngIf="!isContactSelected" class="dot_icon"></div>
            </div>

            <div [ngClass]="dateErrorClass ? 'error_class in_item dl_date_picker':'in_item dl_date_picker'" id="datePicker" ion-datepicker
              [(value)]="initDate" [(min)]="minDate" (ionChanged)="dateSelected($event)" locale="en-US" clear>
              <div class="in_image">
                <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                  <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
                  <title>creation__calendar-icon—active</title>
                  <desc>Created with Sketch.</desc>
                  <defs></defs>
                  <g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-25.000000, -1082.000000)"
                    opacity="0.300000012">
                    <g id="Create-Deal" transform="translate(0.000000, 823.000000)" fill="#000000">
                      <path d="M43.0481348,260.538041 C44.1261547,260.538041 45,261.412378 45,262.491005 L45,277.047036 C45,278.125583 44.1261547,279 43.0481348,279 L26.9518652,279 C25.8738453,279 25,278.125583 25,277.047036 L25,262.491005 C25,261.412378 25.8738453,260.538041 26.9518652,260.538041 L28.8386576,260.538041 L28.8386576,262.069102 C28.8386576,262.923613 29.5334538,263.618801 30.387484,263.618801 L30.403019,263.618801 C31.2570492,263.618801 31.9518454,262.923613 31.9518454,262.069102 L31.9518454,260.538041 L38.064403,260.538041 L38.064403,262.069102 C38.064403,262.923613 38.7591992,263.618801 39.6132293,263.618801 L39.6287644,263.618801 C40.4827946,263.618801 41.17767,262.923613 41.17767,262.069102 L41.17767,260.538041 L43.0481348,260.538041 Z M43.4450706,276.527826 L43.4450706,265.927131 L26.5549294,265.927131 L26.5549294,276.527826 C26.5549294,277.057345 26.9838864,277.486465 27.5130284,277.486465 L42.4869716,277.486465 C43.0161136,277.486465 43.4450706,277.057345 43.4450706,276.527826 Z M32.2290743,268.001844 L37.7707989,268.001844 L37.7707989,269.500232 C37.4428196,269.773596 36.6558437,270.823515 36.1421574,271.960907 C35.5190918,273.306078 35.3551814,274.62936 35.3442435,275.624638 L33.3439503,275.624638 C33.387702,274.727857 33.6609124,273.295133 34.3496055,271.960907 C34.8742297,270.790682 35.6502677,269.86107 35.8798057,269.708011 L35.8798057,269.686044 L32.2290743,269.686044 L32.2290743,268.001844 Z M39.6287723,262.837647 L39.6132373,262.837647 C39.1890359,262.837647 38.8451253,262.493543 38.8451253,262.069102 L38.8451253,259.768624 C38.8451253,259.344104 39.1890359,259 39.6132373,259 L39.6287723,259 C40.0529736,259 40.3968843,259.344104 40.3968843,259.768624 L40.3968843,262.069102 C40.3968843,262.493543 40.0529736,262.837647 39.6287723,262.837647 Z M30.4029873,262.837647 L30.3874523,262.837647 C29.9632509,262.837647 29.6193403,262.493543 29.6193403,262.069102 L29.6193403,259.768624 C29.6193403,259.344104 29.9632509,259 30.3874523,259 L30.4029873,259 C30.8272679,259 31.1710993,259.344104 31.1710993,259.768624 L31.1710993,262.069102 C31.1710993,262.493543 30.8272679,262.837647 30.4029873,262.837647 Z"
                        id="creation__calendar-icon—active"></path>
                    </g>
                  </g>
                </svg>
              </div>
              <ion-item>
                <!-- <ion-input name="closing_date" type="text" placeholder="Expecting closing date" [(ngModel)]="deal.closingDate"></ion-input> -->
                <span *ngIf="isDateSelected">{{initDate | date}}</span>
                <span *ngIf="!isDateSelected">Expecting closing date</span>
              </ion-item>
              <div class="dot_icon" *ngIf="!isDateSelected"></div>
            </div>

            <div class="in_item dl_cat_prodc" id="catandprod">
              <div class="in_image">
                <svg width="20px" height="18px" viewBox="0 0 20 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                  <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
                  <title>creation__category-icon—default</title>
                  <desc>Created with Sketch.</desc>
                  <defs></defs>
                  <g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-25.000000, -1168.000000)"
                    opacity="0.300000012">
                    <g id="Create-Deal" transform="translate(0.000000, 823.000000)" fill="#000000">
                      <path d="M25.0060664,350.401772 C24.9444355,349.816065 25.3602295,349.301887 25.8972252,349.301887 L44.096796,349.301887 C44.6265814,349.301887 45.041002,349.802683 44.989929,350.38151 C44.6730192,353.974253 44.4591136,359.620128 44.4277831,362.26707 C44.4237488,362.602096 44.1754226,362.870965 43.8702724,362.870965 L26.1384269,362.870965 C25.8319891,362.870965 25.5829763,362.599929 25.5809162,362.263395 C25.5606587,358.952808 25.3795428,353.948903 25.0060664,350.401772 Z M33.5927788,346.313246 C33.5927788,346.545173 33.7639376,346.733089 33.9751823,346.733089 L43.436899,346.733089 C43.6480578,346.733089 43.8192166,346.921005 43.8192166,347.152838 L43.8192166,348.042094 L26.1706329,348.042094 L26.1706329,347.152838 C26.1706329,346.921005 26.3417917,346.733089 26.5529505,346.733089 L26.5606758,346.733089 C26.7718346,346.733089 26.9430793,346.545173 26.9430793,346.313246 L26.9430793,345.80199 C26.9430793,345.359152 27.2701179,345 27.6735514,345 L32.8623067,345 C33.2657402,345 33.5927788,345.359152 33.5927788,345.80199 L33.5927788,346.313246 Z"
                        id="creation__category-icon—default"></path>
                    </g>
                  </g>
                </svg>
              </div>
              <ion-item (click)="openCategory();" [class.item_active]="deal.category.name_category!= '' || deal.product.length != 0">
                <p *ngIf="!deal.category.name_category">Category and product(s)</p>
                <!-- Evol Team edited -->
                <p class="main_cat_cls" *ngIf="deal.category.name_category && deal.category.name_category!='undefined' && deal.product.length == 0">{{deal.category.name_category}}</p>
                <p class="main_cat_cls" *ngIf="deal.category.name_category && deal.category.name_category!=='undefined' && deal.product.length != 0">{{deal.category.name_category}} - </p>
                <!-- Evol Team edited -->
                <p *ngFor="let prod of deal.product">
                  {{prod.name_product}}
                </p>
              </ion-item>
            </div>

            <div class="in_item">
              <div class="in_image">
                <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                  <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
                  <title>creation__deal-value-icon—default</title>
                  <desc>Created with Sketch.</desc>
                  <defs></defs>
                  <g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-25.000000, -1251.000000)"
                    opacity="0.300000012">
                    <g id="Create-Deal" transform="translate(0.000000, 823.000000)" fill="#000000">
                      <path d="M35.0000232,428 C40.5228642,428 45,432.477136 45,437.999977 L45,438.000023 C45,443.522864 40.5228642,448 35.0000232,448 L34.9999768,448 C29.4771358,448 25,443.522864 25,438.000023 L25,437.999977 C25,432.477136 29.4771358,428 34.9999768,428 L35.0000232,428 Z M35.3255935,443.597925 C37.1630213,443.494201 38.3484751,442.545829 38.3484751,440.500955 C38.3484751,439.093284 37.6964547,438.293087 36.2591481,437.774425 L35.3255935,437.448438 L35.3255935,434.173704 C36.1850602,434.262609 36.4517768,434.840496 36.4517768,435.625874 L36.4517768,435.833274 L38.1410288,435.833274 L38.1410288,435.625874 C38.1410288,434.573779 37.5779602,432.899345 35.3255935,432.899345 L35.3255935,431.862113 L34.6736194,431.862113 L34.6736194,432.899345 C33.0880906,432.899345 31.8582304,434.099616 31.8582304,435.803685 C31.8582304,437.300262 32.5102045,438.100459 34.066098,438.663527 L34.6736194,438.885791 L34.6736194,442.323565 C33.740111,442.160572 33.39926,441.55305 33.39926,440.456502 L33.39926,440.219421 L31.7100081,440.219421 L31.7100081,440.456502 C31.7100081,441.849356 32.1545822,443.46452 34.6736194,443.597925 L34.6736194,444.872284 L35.3255935,444.872284 L35.3255935,443.597925 Z M35.3255935,439.137723 C36.2295129,439.404439 36.6592231,439.863785 36.6592231,440.841792 C36.6592231,441.508584 36.2146953,442.190193 35.3255935,442.323551 L35.3255935,439.137723 Z M33.5474638,435.655486 C33.5474638,434.721978 34.0512619,434.232951 34.6736008,434.173681 L34.6736008,437.196562 C33.8734508,436.84094 33.5474638,436.351913 33.5474638,435.655486 Z"
                        id="creation__deal-value-icon—default"></path>
                    </g>
                  </g>
                </svg>
              </div>
              <ion-item (click)="openDealValue();" [class.item_active]="deal.totalValue!= ''">
                <ion-input name="deal_value" type="text" placeholder="Deal value" [value]="convertDealValue(deal.totalValue)"></ion-input>
              </ion-item>
            </div>
          </div>
          <button ion-button color="secondary" class="a_new_con_btn del_crt_mdl" type="submit">{{labelName}} DEAL</button>
        </form>
      </div>
    </div>
  </div>
</ion-content>
<!-- Loader -->
<div center middle *ngIf="showloader" class="ldr_mask">
  <div class="mask_outer">
    <div class="mask_inner">
      <ion-spinner name="crescent" color="dark"></ion-spinner>
    </div>
  </div>
</div>
